Overview
--------
Here, you will find the scripts and files that were used to generate the initial unbound states for the weighted ensemble (WE) simulation of the protein-protein binding process involving the barnase and barstar proteins in Saglam & Chong, Chemical Sci. (2019). Each initial unbound state consists of the two proteins separated at a distance of 20 Angstroms and randomly oriented with respect to each other. Conformations of each unbound protein were selected from a preparatory, equilibrium WE simulation of that protein. These preparatory simulations were completed prior to use the scripts in this directory.The Gromacs software package was used for dynamics propagation.

The generation of initial unbound states involved the following two steps:

1) Select conformations of each unbound protein from the final iteration of the corresponding preparatory simulation according to their statistical weights, randomly orient the two proteins at a separation of 20 Angstroms, and multiply together the statistical weights. 

2) Assign the resulting pairs of unbound proteins to appropriate bins along the selected progress coordinate for the binding simulations and prune the lowest-weight trajectories according to the standard WE resampling (split/merge) scheme.

To run the binding simulations in explicit-solvent, the remaining pairs of unbound proteins were immersed in boxes of explicit water after which the solvent was equilibrated while applying harmonic restraints to the positions of the proteins. 

To use the scripts
------------------

To apply the above two steps, we run the following: 

  python build_state_dist_bb.py --reference min.gro --bn unbound.gro --bs barstar.gro --bn_path $PWD/000146/ --bs_path $PWD/000163/ bn_west.h5 bs_west.h5

where --reference is the coordinate file for the energy minimized system consisting of the initial unbound state, --bn is the coordinate file for barnase, --bs is the coordinate file for barstar, --bn_path is the directory of conformations from the last iteration from the preparatory, equilibrium simulation of barnase, --bs_path is the directory of conformations from the last iteration from the preparatory, equilibrium simulation of barstar. 

The conformations in --bn_path and --bs_path are passed into the west.h5 files for the corresponding proteins, bn_west.h5 and bs_west.h5. 

The output will be an HDF5 file called "basis.h5" that contains the basis state information to initialize the WE binding simulation. 

Next, we run a customized, initialization of the binding simulation using the following: 

  w_custom_init.py -b basis.h5 -t ref.pdb

where -b is the basis file generated using "build_state_dist.py" and -t is a reference coordinate file for the final system. 

The output is a west.h5 file that is exactly like the west-h5 file that would be generated by w_init. 

